# TodoList API Documentation

This document describes the REST API endpoints for managing the TodoList table.

## Base URL
```
http://localhost:3000
```

## Endpoints

### 1. Create Todo
**POST** `/todos`

Creates a new todo item.

**Request Body:**
```json
{
  "note": "Buy groceries",
  "status": "pending",
  "order": 1,
  "user_id": 1
}
```

**Response:**
```json
{
  "id": 1,
  "note": "Buy groceries",
  "status": "pending",
  "order": 1,
  "created_at": "2024-08-12T19:30:00.000Z"
}
```

### 2. Get All Todos
**GET** `/todos`

Retrieves all todo items, ordered by the `order` field.

**Query Parameters:**
- `status` (optional): Filter by status (`pending`, `in_progress`, `completed`)
- `user_id` (optional): Filter by user ID

**Examples:**
```
GET /todos
GET /todos?status=pending
GET /todos?status=completed
GET /todos?user_id=1
```

**Response:**
```json
[
  {
    "id": 1,
    "note": "Buy groceries",
    "status": "pending",
    "order": 1,
    "created_at": "2024-08-12T19:30:00.000Z"
  },
  {
    "id": 2,
    "note": "Call mom",
    "status": "completed",
    "order": 2,
    "created_at": "2024-08-12T19:35:00.000Z"
  }
]
```

### 3. Get Todo by ID
**GET** `/todos/:id`

Retrieves a specific todo item by its ID.

**Response:**
```json
{
  "id": 1,
  "note": "Buy groceries",
  "status": "pending",
  "order": 1,
  "created_at": "2024-08-12T19:30:00.000Z"
}
```

### 4. Update Todo
**PATCH** `/todos/:id`

Updates a specific todo item.

**Request Body:**
```json
{
  "note": "Buy groceries and milk",
  "status": "in_progress"
}
```

**Response:**
```json
{
  "id": 1,
  "note": "Buy groceries and milk",
  "status": "in_progress",
  "order": 1,
  "created_at": "2024-08-12T19:30:00.000Z"
}
```

### 5. Update Todo Order
**PATCH** `/todos/:id/order`

Updates the order of a specific todo item.

**Request Body:**
```json
{
  "order": 3
}
```

**Response:**
```json
{
  "id": 1,
  "note": "Buy groceries",
  "status": "pending",
  "order": 3,
  "created_at": "2024-08-12T19:30:00.000Z"
}
```

### 6. Delete Todo
**DELETE** `/todos/:id`

Deletes a specific todo item.

**Response:**
```
204 No Content
```

## Data Types

### TodoStatus Enum
- `pending` - Todo is not started
- `in_progress` - Todo is currently being worked on
- `completed` - Todo is finished

### Todo Object
```typescript
interface Todo {
  id: number;           // Primary key (auto-generated)
  note: string;         // The todo description
  status: TodoStatus;   // Current status
  order: number;        // Display order
  user_id?: number;     // Associated user ID (optional)
  created_at: string;   // Creation timestamp (auto-generated)
}
```

## Error Responses

### 404 Not Found
```json
{
  "statusCode": 404,
  "message": "Todo with ID 999 not found",
  "error": "Not Found"
}
```

### 400 Bad Request
```json
{
  "statusCode": 400,
  "message": [
    "note should not be empty",
    "status must be one of the following values: pending, in_progress, completed"
  ],
  "error": "Bad Request"
}
```

## Example Usage with curl

### Create a todo
```bash
curl -X POST http://localhost:3000/todos \
  -H "Content-Type: application/json" \
  -d '{"note": "Learn NestJS", "status": "pending"}'
```

### Get all todos
```bash
curl http://localhost:3000/todos
```

### Update a todo
```bash
curl -X PATCH http://localhost:3000/todos/1 \
  -H "Content-Type: application/json" \
  -d '{"status": "completed"}'
```

### Delete a todo
```bash
curl -X DELETE http://localhost:3000/todos/1
```

## Notes

- The `id` and `created_at` fields are automatically generated by Supabase
- If no `order` is provided when creating a todo, it will be set to the next available order number
- Todos are always returned ordered by the `order` field in ascending order
- The API uses validation pipes to ensure data integrity
